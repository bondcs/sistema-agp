var ZeroClipboard_TableTools={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(b){"string"==typeof b&&(b=document.getElementById(b));b.addClass||(b.hide=function(){this.style.display="none"},b.show=function(){this.style.display=""},b.addClass=function(c){this.removeClass(c);this.className+=" "+c},b.removeClass=function(c){this.className=this.className.replace(RegExp("\\s*"+c+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},b.hasClass=function(c){return !!this.className.match(RegExp("\\s*"+c+"\\s*"))});return b},setMoviePath:function(b){this.moviePath=b},dispatch:function(e,d,f){(e=this.clients[e])&&e.receiveEvent(d,f)},register:function(d,c){this.clients[d]=c},getDOMObjectPosition:function(d){var c={left:0,top:0,width:d.width?d.width:d.offsetWidth,height:d.height?d.height:d.offsetHeight};""!=d.style.width&&(c.width=d.style.width.replace("px",""));""!=d.style.height&&(c.height=d.style.height.replace("px",""));for(;d;){c.left+=d.offsetLeft,c.top+=d.offsetTop,d=d.offsetParent}return c},Client:function(b){this.handlers={};this.id=ZeroClipboard_TableTools.nextId++;this.movieId="ZeroClipboard_TableToolsMovie_"+this.id;ZeroClipboard_TableTools.register(this.id,this);b&&this.glue(b)}};ZeroClipboard_TableTools.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(g,f){this.domElement=ZeroClipboard_TableTools.$(g);var k=99;this.domElement.style.zIndex&&(k=parseInt(this.domElement.style.zIndex)+1);var j=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");var h=this.div.style;h.position="absolute";h.left="0px";h.top="0px";h.width=j.width+"px";h.height=j.height+"px";h.zIndex=k;"undefined"!=typeof f&&""!=f&&(this.div.title=f);0!=j.width&&0!=j.height&&(this.sized=!0);this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(j.width,j.height))},positionElement:function(){var d=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),c=this.div.style;c.position="absolute";c.width=d.width+"px";c.height=d.height+"px";0!=d.width&&0!=d.height&&(this.sized=!0,c=this.div.childNodes[0],c.width=d.width,c.height=d.height)},getHTML:function(g,f){var k="",j="id="+this.id+"&width="+g+"&height="+f;if(navigator.userAgent.match(/MSIE/)){var h=location.href.match(/^https/i)?"https://":"http://",k=k+('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+h+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+g+'" height="'+f+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard_TableTools.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+j+'"/><param name="wmode" value="transparent"/></object>')}else{k+='<embed id="'+this.movieId+'" src="'+ZeroClipboard_TableTools.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+g+'" height="'+f+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+j+'" wmode="transparent" />'}return k},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var d=document.getElementsByTagName("body")[0];try{d.removeChild(this.div)}catch(c){}this.div=this.domElement=null}},reposition:function(d){d&&((this.domElement=ZeroClipboard_TableTools.$(d))||this.hide());if(this.domElement&&this.div){var d=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),c=this.div.style;c.left=""+d.left+"px";c.top=""+d.top+"px"}},clearText:function(){this.clipText="";this.ready&&this.movie.clearText()},appendText:function(b){this.clipText+=b;this.ready&&this.movie.appendText(b)},setText:function(b){this.clipText=b;this.ready&&this.movie.setText(b)},setCharSet:function(b){this.charSet=b;this.ready&&this.movie.setCharSet(b)},setBomInc:function(b){this.incBom=b;this.ready&&this.movie.setBomInc(b)},setFileName:function(b){this.fileName=b;this.ready&&this.movie.setFileName(b)},setAction:function(b){this.action=b;this.ready&&this.movie.setAction(b)},addEventListener:function(d,c){d=d.toString().toLowerCase().replace(/^on/,"");this.handlers[d]||(this.handlers[d]=[]);this.handlers[d].push(c)},setHandCursor:function(b){this.handCursorEnabled=b;this.ready&&this.movie.setHandCursor(b)},setCSSEffects:function(b){this.cssEffects=!!b},receiveEvent:function(h,g){h=h.toString().toLowerCase().replace(/^on/,"");switch(h){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var m=this;setTimeout(function(){m.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){m=this;setTimeout(function(){m.receiveEvent("load",null)},100);this.ready=!0;return}this.ready=!0;this.movie.clearText();this.movie.appendText(this.clipText);this.movie.setFileName(this.fileName);this.movie.setAction(this.action);this.movie.setCharSet(this.charSet);this.movie.setBomInc(this.incBom);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[h]){for(var l=0,k=this.handlers[h].length;l<k;l++){var j=this.handlers[h][l];if("function"==typeof j){j(this,g)}else{if("object"==typeof j&&2==j.length){j[0][j[1]](this,g)}else{if("string"==typeof j){window[j](this,g)}}}}}}};var TableTools;(function(b,c,a){TableTools=function(e,d){!this instanceof TableTools&&alert("Warning: TableTools must be initialised with the keyword 'new'");this.s={that:this,dt:e.fnSettings(),print:{saveStart:-1,saveLength:-1,saveScroll:-1,funcEnd:function(){}},buttonCounter:0,select:{type:"",selected:[],preRowSelect:null,postSelected:null,postDeselected:null,all:!1,selectedClass:""},custom:{},swfPath:"",buttonSet:[],master:!1,tags:{}};this.dom={container:null,table:null,print:{hidden:[],message:null},collection:{collection:null,background:null}};this.classes=b.extend(!0,{},TableTools.classes);this.s.dt.bJUI&&b.extend(!0,this.classes,TableTools.classes_themeroller);this.fnSettings=function(){return this.s};"undefined"==typeof d&&(d={});this._fnConstruct(d);return this};TableTools.prototype={fnGetSelected:function(g){var f=[],k=this.s.dt.aoData,j=this.s.dt.aiDisplay,h;if(g){g=0;for(h=j.length;g<h;g++){k[j[g]]._DTTT_selected&&f.push(k[j[g]].nTr)}}else{g=0;for(h=k.length;g<h;g++){k[g]._DTTT_selected&&f.push(k[g].nTr)}}return f},fnGetSelectedData:function(){var f=[],e=this.s.dt.aoData,h,g;h=0;for(g=e.length;h<g;h++){e[h]._DTTT_selected&&f.push(this.s.dt.oInstance.fnGetData(h))}return f},fnIsSelected:function(d){d=this.s.dt.oInstance.fnGetPosition(d);return !0===this.s.dt.aoData[d]._DTTT_selected?!0:!1},fnSelectAll:function(e){var d=this._fnGetMasterSettings();this._fnRowSelect(!0===e?d.dt.aiDisplay:d.dt.aoData)},fnSelectNone:function(d){this._fnGetMasterSettings();this._fnRowDeselect(this.fnGetSelected(d))},fnSelect:function(d){"single"==this.s.select.type?(this.fnSelectNone(),this._fnRowSelect(d)):"multi"==this.s.select.type&&this._fnRowSelect(d)},fnDeselect:function(d){this._fnRowDeselect(d)},fnGetTitle:function(e){var d="";"undefined"!=typeof e.sTitle&&""!==e.sTitle?d=e.sTitle:(e=a.getElementsByTagName("title"),0<e.length&&(d=e[0].innerHTML));return 4>"\u00a1".toString().length?d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""):d.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")},fnCalcColRatios:function(j){var h=this.s.dt.aoColumns,j=this._fnColumnTargets(j.mColumns),o=[],n=0,m=0,l,k;l=0;for(k=j.length;l<k;l++){j[l]&&(n=h[l].nTh.offsetWidth,m+=n,o.push(n))}l=0;for(k=o.length;l<k;l++){o[l]/=m}return o.join("\t")},fnGetTableData:function(d){if(this.s.dt){return this._fnGetDataTablesData(d)}},fnSetText:function(e,d){this._fnFlashSetText(e,d)},fnResizeButtons:function(){for(var e in ZeroClipboard_TableTools.clients){if(e){var d=ZeroClipboard_TableTools.clients[e];"undefined"!=typeof d.domElement&&d.domElement.parentNode&&d.positionElement()}}},fnResizeRequired:function(){for(var e in ZeroClipboard_TableTools.clients){if(e){var d=ZeroClipboard_TableTools.clients[e];if("undefined"!=typeof d.domElement&&d.domElement.parentNode==this.dom.container&&!1===d.sized){return !0}}}return !1},fnPrint:function(e,d){void 0===d&&(d={});void 0===e||e?this._fnPrintStart(d):this._fnPrintEnd()},fnInfo:function(e,d){var f=a.createElement("div");f.className=this.classes.print.info;f.innerHTML=e;a.body.appendChild(f);setTimeout(function(){b(f).fadeOut("normal",function(){a.body.removeChild(f)})},d)},_fnConstruct:function(e){var d=this;this._fnCustomiseSettings(e);this.dom.container=a.createElement(this.s.tags.container);this.dom.container.className=this.classes.container;"none"!=this.s.select.type&&this._fnRowSelectConfig();this._fnButtonDefinations(this.s.buttonSet,this.dom.container);this.s.dt.aoDestroyCallback.push({sName:"TableTools",fn:function(){d.dom.container.innerHTML=""}})},_fnCustomiseSettings:function(d){"undefined"==typeof this.s.dt._TableToolsInit&&(this.s.master=!0,this.s.dt._TableToolsInit=!0);this.dom.table=this.s.dt.nTable;this.s.custom=b.extend({},TableTools.DEFAULTS,d);this.s.swfPath=this.s.custom.sSwfPath;"undefined"!=typeof ZeroClipboard_TableTools&&(ZeroClipboard_TableTools.moviePath=this.s.swfPath);this.s.select.type=this.s.custom.sRowSelect;this.s.select.preRowSelect=this.s.custom.fnPreRowSelect;this.s.select.postSelected=this.s.custom.fnRowSelected;this.s.select.postDeselected=this.s.custom.fnRowDeselected;this.s.custom.sSelectedClass&&(this.classes.select.row=this.s.custom.sSelectedClass);this.s.tags=this.s.custom.oTags;this.s.buttonSet=this.s.custom.aButtons},_fnButtonDefinations:function(g,f){for(var k,j=0,h=g.length;j<h;j++){if("string"==typeof g[j]){if("undefined"==typeof TableTools.BUTTONS[g[j]]){alert("TableTools: Warning - unknown button type: "+g[j]);continue}k=b.extend({},TableTools.BUTTONS[g[j]],!0)}else{if("undefined"==typeof TableTools.BUTTONS[g[j].sExtends]){alert("TableTools: Warning - unknown button type: "+g[j].sExtends);continue}k=b.extend({},TableTools.BUTTONS[g[j].sExtends],!0);k=b.extend(k,g[j],!0)}f.appendChild(this._fnCreateButton(k,b(f).hasClass(this.classes.collection.container)))}},_fnCreateButton:function(e,d){var f=this._fnButtonBase(e,d);e.sAction.match(/flash/)?this._fnFlashConfig(f,e):"text"==e.sAction?this._fnTextConfig(f,e):"div"==e.sAction?this._fnTextConfig(f,e):"collection"==e.sAction&&(this._fnTextConfig(f,e),this._fnCollectionConfig(f,e));return f},_fnButtonBase:function(h,g){var m,l,k;g?(m="default"!==h.sTag?h.sTag:this.s.tags.collection.button,l="default"!==h.sLinerTag?h.sLiner:this.s.tags.collection.liner,k=this.classes.collection.buttons.normal):(m="default"!==h.sTag?h.sTag:this.s.tags.button,l="default"!==h.sLinerTag?h.sLiner:this.s.tags.liner,k=this.classes.buttons.normal);m=a.createElement(m);l=a.createElement(l);var j=this._fnGetMasterSettings();m.className=k+" "+h.sButtonClass;m.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+j.buttonCounter);m.appendChild(l);l.innerHTML=h.sButtonText;j.buttonCounter++;return m},_fnGetMasterSettings:function(){if(this.s.master){return this.s}for(var e=TableTools._aInstances,d=0,f=e.length;d<f;d++){if(this.dom.table==e[d].s.dt.nTable){return e[d].s}}},_fnCollectionConfig:function(e,d){var f=a.createElement(this.s.tags.collection.container);f.style.display="none";f.className=this.classes.collection.container;d._collection=f;a.body.appendChild(f);this._fnButtonDefinations(d.aButtons,f)},_fnCollectionShow:function(w,v){var u=this,t=b(w).offset(),s=v._collection,q=t.left,t=t.top+b(w).outerHeight(),g=b(c).height(),r=b(a).height(),p=b(c).width(),f=b(a).width();s.style.position="absolute";s.style.left=q+"px";s.style.top=t+"px";s.style.display="block";b(s).css("opacity",0);var n=a.createElement("div");n.style.position="absolute";n.style.left="0px";n.style.top="0px";n.style.height=(g>r?g:r)+"px";n.style.width=(p>f?p:f)+"px";n.className=this.classes.collection.background;b(n).css("opacity",0);a.body.appendChild(n);a.body.appendChild(s);g=b(s).outerWidth();p=b(s).outerHeight();q+g>f&&(s.style.left=f-g+"px");t+p>r&&(s.style.top=t-p-b(w).outerHeight()+"px");this.dom.collection.collection=s;this.dom.collection.background=n;setTimeout(function(){b(s).animate({opacity:1},500);b(n).animate({opacity:0.25},500)},10);this.fnResizeButtons();b(n).click(function(){u._fnCollectionHide.call(u,null,null)})},_fnCollectionHide:function(e,d){!(null!==d&&"collection"==d.sExtends)&&null!==this.dom.collection.collection&&(b(this.dom.collection.collection).animate({opacity:0},500,function(){this.style.display="none"}),b(this.dom.collection.background).animate({opacity:0},500,function(){this.parentNode.removeChild(this)}),this.dom.collection.collection=null,this.dom.collection.background=null)},_fnRowSelectConfig:function(){if(this.s.master){var e=this,d=this.s.dt;b(d.nTable).addClass(this.classes.select.table);b("tr",d.nTBody).live("click",function(f){this.parentNode==d.nTBody&&null!==d.oInstance.fnGetData(this)&&(e.fnIsSelected(this)?e._fnRowDeselect(this,f):"single"==e.s.select.type?(e.fnSelectNone(),e._fnRowSelect(this,f)):"multi"==e.s.select.type&&e._fnRowSelect(this,f))});d.oApi._fnCallbackReg(d,"aoRowCreatedCallback",function(h,g,f){d.aoData[f]._DTTT_selected&&b(h).addClass(e.classes.select.row)},"TableTools-SelectAll")}},_fnRowSelect:function(g,f){var m=this._fnSelectData(g),l=[],k,h;k=0;for(h=m.length;k<h;k++){m[k].nTr&&l.push(m[k].nTr)}if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,f,l,!0)){k=0;for(h=m.length;k<h;k++){m[k]._DTTT_selected=!0,m[k].nTr&&b(m[k].nTr).addClass(this.classes.select.row)}null!==this.s.select.postSelected&&this.s.select.postSelected.call(this,l);TableTools._fnEventDispatch(this,"select",l,!0)}},_fnRowDeselect:function(g,f){var m=this._fnSelectData(g),l=[],k,h;k=0;for(h=m.length;k<h;k++){m[k].nTr&&l.push(m[k].nTr)}if(null===this.s.select.preRowSelect||this.s.select.preRowSelect.call(this,f,l,!1)){k=0;for(h=m.length;k<h;k++){m[k]._DTTT_selected=!1,m[k].nTr&&b(m[k].nTr).removeClass(this.classes.select.row)}null!==this.s.select.postDeselected&&this.s.select.postDeselected.call(this,l);TableTools._fnEventDispatch(this,"select",l,!1)}},_fnSelectData:function(g){var f=[],k,j,h;if(g.nodeName){k=this.s.dt.oInstance.fnGetPosition(g),f.push(this.s.dt.aoData[k])}else{if("undefined"!==typeof g.length){j=0;for(h=g.length;j<h;j++){g[j].nodeName?(k=this.s.dt.oInstance.fnGetPosition(g[j]),f.push(this.s.dt.aoData[k])):"number"===typeof g[j]?f.push(this.s.dt.aoData[g[j]]):f.push(g[j])}}else{f.push(g)}}return f},_fnTextConfig:function(e,d){var f=this;null!==d.fnInit&&d.fnInit.call(this,e,d);""!==d.sToolTip&&(e.title=d.sToolTip);b(e).hover(function(){d.fnMouseover!==null&&d.fnMouseover.call(this,e,d,null)},function(){d.fnMouseout!==null&&d.fnMouseout.call(this,e,d,null)});null!==d.fnSelect&&TableTools._fnEventListen(this,"select",function(g){d.fnSelect.call(f,e,d,g)});b(e).click(function(){d.fnClick!==null&&d.fnClick.call(f,e,d,null);d.fnComplete!==null&&d.fnComplete.call(f,e,d,null,null);f._fnCollectionHide(e,d)})},_fnFlashConfig:function(f,e){var h=this,g=new ZeroClipboard_TableTools.Client;null!==e.fnInit&&e.fnInit.call(this,f,e);g.setHandCursor(!0);"flash_save"==e.sAction?(g.setAction("save"),g.setCharSet("utf16le"==e.sCharSet?"UTF16LE":"UTF8"),g.setBomInc(e.bBomInc),g.setFileName(e.sFileName.replace("*",this.fnGetTitle(e)))):"flash_pdf"==e.sAction?(g.setAction("pdf"),g.setFileName(e.sFileName.replace("*",this.fnGetTitle(e)))):g.setAction("copy");g.addEventListener("mouseOver",function(){e.fnMouseover!==null&&e.fnMouseover.call(h,f,e,g)});g.addEventListener("mouseOut",function(){e.fnMouseout!==null&&e.fnMouseout.call(h,f,e,g)});g.addEventListener("mouseDown",function(){e.fnClick!==null&&e.fnClick.call(h,f,e,g)});g.addEventListener("complete",function(j,d){e.fnComplete!==null&&e.fnComplete.call(h,f,e,g,d);h._fnCollectionHide(f,e)});this._fnFlashGlue(g,f,e.sToolTip)},_fnFlashGlue:function(g,f,k){var j=this,h=f.getAttribute("id");a.getElementById(h)?g.glue(f,k):setTimeout(function(){j._fnFlashGlue(g,f,k)},100)},_fnFlashSetText:function(g,f){var k=this._fnChunkData(f,8192);g.clearText();for(var j=0,h=k.length;j<h;j++){g.appendText(k[j])}},_fnColumnTargets:function(e){var d=[],f=this.s.dt;if("object"==typeof e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(!1)}i=0;for(iLen=e.length;i<iLen;i++){d[e[i]]=!0}}else{if("visible"==e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bVisible?!0:!1)}}else{if("hidden"==e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bVisible?!1:!0)}}else{if("sortable"==e){i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(f.aoColumns[i].bSortable?!0:!1)}}else{i=0;for(iLen=f.aoColumns.length;i<iLen;i++){d.push(!0)}}}}}return d},_fnNewline:function(d){return"auto"==d.sNewLine?navigator.userAgent.match(/Windows/)?"\r\n":"\n":d.sNewLine},_fnGetDataTablesData:function(A){var z,y,x,w,t,v=[],u="",s=this.s.dt,m,r=RegExp(A.sFieldBoundary,"g"),q=this._fnColumnTargets(A.mColumns);x="undefined"!=typeof A.bSelectedOnly?A.bSelectedOnly:!1;if(A.bHeader){t=[];z=0;for(y=s.aoColumns.length;z<y;z++){q[z]&&(u=s.aoColumns[z].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,""),u=this._fnHtmlDecode(u),t.push(this._fnBoundData(u,A.sFieldBoundary,r)))}v.push(t.join(A.sFieldSeperator))}var f=s.aiDisplay;w=this.fnGetSelected();if("none"!==this.s.select.type&&x&&0!==w.length){f=[];z=0;for(y=w.length;z<y;z++){f.push(s.oInstance.fnGetPosition(w[z]))}}x=0;for(w=f.length;x<w;x++){m=s.aoData[f[x]].nTr;t=[];z=0;for(y=s.aoColumns.length;z<y;z++){q[z]&&(u=s.oApi._fnGetCellData(s,f[x],z,"display"),A.fnCellRender?u=A.fnCellRender(u,z,m,f[x])+"":"string"==typeof u?(u=u.replace(/\n/g," "),u=u.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3"),u=u.replace(/<.*?>/g,"")):u+="",u=u.replace(/^\s+/,"").replace(/\s+$/,""),u=this._fnHtmlDecode(u),t.push(this._fnBoundData(u,A.sFieldBoundary,r)))}v.push(t.join(A.sFieldSeperator));A.bOpenRows&&(z=b.grep(s.aoOpenRows,function(d){return d.nParent===m}),1===z.length&&(u=this._fnBoundData(b("td",z[0].nTr).html(),A.sFieldBoundary,r),v.push(u)))}if(A.bFooter&&null!==s.nTFoot){t=[];z=0;for(y=s.aoColumns.length;z<y;z++){q[z]&&null!==s.aoColumns[z].nTf&&(u=s.aoColumns[z].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,""),u=this._fnHtmlDecode(u),t.push(this._fnBoundData(u,A.sFieldBoundary,r)))}v.push(t.join(A.sFieldSeperator))}return _sLastData=v.join(this._fnNewline(A))},_fnBoundData:function(e,d,f){return""===d?e:d+e.replace(f,d+d)+d},_fnChunkData:function(g,f){for(var k=[],j=g.length,h=0;h<j;h+=f){h+f<j?k.push(g.substring(h,h+f)):k.push(g.substring(h,j))}return k},_fnHtmlDecode:function(e){if(-1===e.indexOf("&")){return e}var d=a.createElement("div");return e.replace(/&([^\s]*);/g,function(f,g){if("#"===f.substr(1,1)){return String.fromCharCode(Number(g.substr(1)))}d.innerHTML=f;return d.childNodes[0].nodeValue})},_fnPrintStart:function(h){var g=this,o=this.s.dt;this._fnPrintHideNodes(o.nTable);this.s.print.saveStart=o._iDisplayStart;this.s.print.saveLength=o._iDisplayLength;h.bShowAll&&(o._iDisplayStart=0,o._iDisplayLength=-1,o.oApi._fnCalculateEnd(o),o.oApi._fnDraw(o));if(""!==o.oScroll.sX||""!==o.oScroll.sY){this._fnPrintScrollStart(o),b(this.s.dt.nTable).bind("draw.DTTT_Print",function(){g._fnPrintScrollStart(o)})}var n=o.aanFeatures,l;for(l in n){if("i"!=l&&"t"!=l&&1==l.length){for(var k=0,f=n[l].length;k<f;k++){this.dom.print.hidden.push({node:n[l][k],display:"block"}),n[l][k].style.display="none"}}}b(a.body).addClass(this.classes.print.body);""!==h.sInfo&&this.fnInfo(h.sInfo,3000);h.sMessage&&(this.dom.print.message=a.createElement("div"),this.dom.print.message.className=this.classes.print.message,this.dom.print.message.innerHTML=h.sMessage,a.body.insertBefore(this.dom.print.message,a.body.childNodes[0]));this.s.print.saveScroll=b(c).scrollTop();c.scrollTo(0,0);b(a).bind("keydown.DTTT",function(d){if(d.keyCode==27){d.preventDefault();g._fnPrintEnd.call(g,d)}})},_fnPrintEnd:function(){var e=this.s.dt,d=this.s.print,f=this.dom.print;this._fnPrintShowNodes();if(""!==e.oScroll.sX||""!==e.oScroll.sY){b(this.s.dt.nTable).unbind("draw.DTTT_Print"),this._fnPrintScrollEnd()}c.scrollTo(0,d.saveScroll);null!==f.message&&(a.body.removeChild(f.message),f.message=null);b(a.body).removeClass("DTTT_Print");e._iDisplayStart=d.saveStart;e._iDisplayLength=d.saveLength;e.oApi._fnCalculateEnd(e);e.oApi._fnDraw(e);b(a).unbind("keydown.DTTT")},_fnPrintScrollStart:function(){var e=this.s.dt;e.nScrollHead.getElementsByTagName("div")[0].getElementsByTagName("table");var d=e.nTable.parentNode,f=e.nTable.getElementsByTagName("thead");0<f.length&&e.nTable.removeChild(f[0]);null!==e.nTFoot&&(f=e.nTable.getElementsByTagName("tfoot"),0<f.length&&e.nTable.removeChild(f[0]));f=e.nTHead.cloneNode(!0);e.nTable.insertBefore(f,e.nTable.childNodes[0]);null!==e.nTFoot&&(f=e.nTFoot.cloneNode(!0),e.nTable.insertBefore(f,e.nTable.childNodes[1]));""!==e.oScroll.sX&&(e.nTable.style.width=b(e.nTable).outerWidth()+"px",d.style.width=b(e.nTable).outerWidth()+"px",d.style.overflow="visible");""!==e.oScroll.sY&&(d.style.height=b(e.nTable).outerHeight()+"px",d.style.overflow="visible")},_fnPrintScrollEnd:function(){var e=this.s.dt,d=e.nTable.parentNode;""!==e.oScroll.sX&&(d.style.width=e.oApi._fnStringToCss(e.oScroll.sX),d.style.overflow="auto");""!==e.oScroll.sY&&(d.style.height=e.oApi._fnStringToCss(e.oScroll.sY),d.style.overflow="auto")},_fnPrintShowNodes:function(){for(var e=this.dom.print.hidden,d=0,f=e.length;d<f;d++){e[d].node.style.display=e[d].display}e.splice(0,e.length)},_fnPrintHideNodes:function(j){for(var h=this.dom.print.hidden,o=j.parentNode,n=o.childNodes,l=0,k=n.length;l<k;l++){if(n[l]!=j&&1==n[l].nodeType){var f=b(n[l]).css("display");"none"!=f&&(h.push({node:n[l],display:f}),n[l].style.display="none")}}"BODY"!=o.nodeName&&this._fnPrintHideNodes(o)}};TableTools._aInstances=[];TableTools._aListeners=[];TableTools.fnGetMasters=function(){for(var e=[],d=0,f=TableTools._aInstances.length;d<f;d++){TableTools._aInstances[d].s.master&&e.push(TableTools._aInstances[d])}return e};TableTools.fnGetInstance=function(e){"object"!=typeof e&&(e=a.getElementById(e));for(var d=0,f=TableTools._aInstances.length;d<f;d++){if(TableTools._aInstances[d].s.master&&TableTools._aInstances[d].dom.table==e){return TableTools._aInstances[d]}}return null};TableTools._fnEventListen=function(e,d,f){TableTools._aListeners.push({that:e,type:d,fn:f})};TableTools._fnEventDispatch=function(j,h,o,n){for(var m=TableTools._aListeners,l=0,k=m.length;l<k;l++){j.dom.table==m[l].that.dom.table&&m[l].type==h&&m[l].fn(o,n)}};TableTools.buttonBase={sAction:"text",sTag:"default",sLinerTag:"default",sButtonClass:"DTTT_button_text",sButtonText:"Button text",sTitle:"",sToolTip:"",sCharSet:"utf8",bBomInc:!1,sFileName:"*.csv",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"auto",mColumns:"all",bHeader:!0,bFooter:!0,bOpenRows:!1,bSelectedOnly:!1,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:null,fnComplete:null,fnInit:null,fnCellRender:null};TableTools.BUTTONS={csv:b.extend({},TableTools.buttonBase,{sAction:"flash_save",sButtonClass:"DTTT_button_csv",sButtonText:"CSV",sFieldBoundary:'"',sFieldSeperator:",",fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))}}),xls:b.extend({},TableTools.buttonBase,{sAction:"flash_save",sCharSet:"utf16le",bBomInc:!0,sButtonClass:"DTTT_button_xls",sButtonText:"Excel",fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))}}),copy:b.extend({},TableTools.buttonBase,{sAction:"flash_copy",sButtonClass:"DTTT_button_copy",sButtonText:"Copy",fnClick:function(e,d,f){this.fnSetText(f,this.fnGetTableData(d))},fnComplete:function(f,e,h,g){f=g.split("\n").length;f=null===this.s.dt.nTFoot?f-1:f-2;this.fnInfo("<h6>Table copied</h6><p>Copied "+f+" row"+(1==f?"":"s")+" to the clipboard.</p>",1500)}}),pdf:b.extend({},TableTools.buttonBase,{sAction:"flash_pdf",sNewLine:"\n",sFileName:"*.pdf",sButtonClass:"DTTT_button_pdf",sButtonText:"PDF",sPdfOrientation:"portrait",sPdfSize:"A4",sPdfMessage:"",fnClick:function(e,d,f){this.fnSetText(f,"title:"+this.fnGetTitle(d)+"\nmessage:"+d.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(d)+"\norientation:"+d.sPdfOrientation+"\nsize:"+d.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(d))}}),print:b.extend({},TableTools.buttonBase,{sInfo:"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.",sMessage:null,bShowAll:!0,sToolTip:"View print view",sButtonClass:"DTTT_button_print",sButtonText:"Print",fnClick:function(e,d){this.fnPrint(!0,d)}}),text:b.extend({},TableTools.buttonBase),select:b.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(d){0!==this.fnGetSelected().length?b(d).removeClass(this.classes.buttons.disabled):b(d).addClass(this.classes.buttons.disabled)},fnInit:function(d){b(d).addClass(this.classes.buttons.disabled)}}),select_single:b.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(d){1==this.fnGetSelected().length?b(d).removeClass(this.classes.buttons.disabled):b(d).addClass(this.classes.buttons.disabled)},fnInit:function(d){b(d).addClass(this.classes.buttons.disabled)}}),select_all:b.extend({},TableTools.buttonBase,{sButtonText:"Select all",fnClick:function(){this.fnSelectAll()},fnSelect:function(d){this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()?b(d).addClass(this.classes.buttons.disabled):b(d).removeClass(this.classes.buttons.disabled)}}),select_none:b.extend({},TableTools.buttonBase,{sButtonText:"Deselect all",fnClick:function(){this.fnSelectNone()},fnSelect:function(d){0!==this.fnGetSelected().length?b(d).removeClass(this.classes.buttons.disabled):b(d).addClass(this.classes.buttons.disabled)},fnInit:function(d){b(d).addClass(this.classes.buttons.disabled)}}),ajax:b.extend({},TableTools.buttonBase,{sAjaxUrl:"/xhr.php",sButtonText:"Ajax button",fnClick:function(e,d){var f=this.fnGetTableData(d);b.ajax({url:d.sAjaxUrl,data:[{name:"tableData",value:f}],success:d.fnAjaxComplete,dataType:"json",type:"POST",cache:!1,error:function(){alert("Error detected when sending table data to server")}})},fnAjaxComplete:function(){alert("Ajax complete")}}),div:b.extend({},TableTools.buttonBase,{sAction:"div",sTag:"div",sButtonClass:"DTTT_nonbutton",sButtonText:"Text button"}),collection:b.extend({},TableTools.buttonBase,{sAction:"collection",sButtonClass:"DTTT_button_collection",sButtonText:"Collection",fnClick:function(e,d){this._fnCollectionShow(e,d)}})};TableTools.classes={container:"DTTT_container",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"},collection:{container:"DTTT_collection",background:"DTTT_collection_background",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"}},select:{table:"DTTT_selectable",row:"DTTT_selected"},print:{body:"DTTT_Print",info:"DTTT_print_info",message:"DTTT_PrintMessage"}};TableTools.classes_themeroller={container:"DTTT_container ui-buttonset ui-buttonset-multi",buttons:{normal:"DTTT_button ui-button ui-state-default"},collection:{container:"DTTT_collection ui-buttonset ui-buttonset-multi"}};TableTools.DEFAULTS={sSwfPath:"media/swf/copy_csv_xls_pdf.swf",sRowSelect:"none",sSelectedClass:null,fnPreRowSelect:null,fnRowSelected:null,fnRowDeselected:null,aButtons:["copy","csv","xls","pdf","print"],oTags:{container:"div",button:"a",liner:"span",collection:{container:"div",button:"a",liner:"span"}}};TableTools.prototype.CLASS="TableTools";TableTools.VERSION="2.1.4";TableTools.prototype.VERSION=TableTools.VERSION;"function"==typeof b.fn.dataTable&&"function"==typeof b.fn.dataTableExt.fnVersionCheck&&b.fn.dataTableExt.fnVersionCheck("1.9.0")?b.fn.dataTableExt.aoFeatures.push({fnInit:function(d){d=new TableTools(d.oInstance,"undefined"!=typeof d.oInit.oTableTools?d.oInit.oTableTools:{});TableTools._aInstances.push(d);return d.dom.container},cFeature:"T",sFeature:"TableTools"}):alert("Warning: TableTools 2 requires DataTables 1.9.0 or newer - www.datatables.net/download");b.fn.DataTable.TableTools=TableTools})(jQuery,window,document);